import pandas as pd
import numpy as np

source_file = '01.08.xlsx'
target_file = 'target.xlsx'
modified_file = 'target_modified.xlsx'

df_source = pd.read_excel(source_file)
df_subset = df_source.sample(frac=0.92)


df_subset.to_excel(target_file, index=False)

df = df_subset.copy()
cols_to_change = [col for col in df.columns if col.lower() != 'id']
change_indices = df.sample(frac=0.1).index

for col in cols_to_change:
    if np.issubdtype(df[col].dtype, np.number):
        df[col] = df[col].astype(float)
        df.loc[change_indices, col] = df.loc[change_indices, col] * 1.1
    else:
        df[col] = df[col].astype(object)
        df.loc[change_indices, col] = "mod_" + df.loc[change_indices, col].astype(str)

df.to_excel(modified_file, index=False)
